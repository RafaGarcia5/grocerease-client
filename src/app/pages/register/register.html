<main>
    <div class="form-side">
        <a class="main-logo" [routerLink]="routes.user.home">
            <img src="assets/logo-grocerease-white.png" alt="Grocerease logo" />
        </a>
        <div class="form-container">
            <div class="form-title">
                <h1>Sign Up</h1>
            </div>
            <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="form-content">
                <mat-form-field appearance="outline">
                    <mat-label>Name</mat-label>
                    <input matInput formControlName="name" required maxlength="250"/>
                    @if (registerForm.get('name')?.hasError('required')) {
                        <mat-error>Name is required</mat-error>
                    }
                </mat-form-field>
            
                <mat-form-field appearance="outline">
                    <mat-label>Email</mat-label>
                    <input matInput type="email" formControlName="email" required maxlength="250"/>
                    @if (registerForm.get('email')?.hasError('required')) {
                        <mat-error>Email is required</mat-error>
                    }
                    @if (registerForm.get('email')?.hasError('backend')) {
                        <mat-error>{{ registerForm.get('email')?.getError('backend') }}</mat-error>
                    }
                </mat-form-field>
            
                <mat-form-field appearance="outline">
                    <mat-label>Password</mat-label>
                    <input matInput type="password" formControlName="password" required minlength="8" maxlength="15" />
                    @if (registerForm.get('password')?.hasError('required')) {
                        <mat-error>Password is required</mat-error>
                    }@if (registerForm.get('password')?.hasError('minlength')) {
                        <mat-error>Password must be between 8-15 characters</mat-error>
                    }
                </mat-form-field>

                <mat-form-field appearance="outline">
                    <mat-label>Confirm Password</mat-label>
                    <input matInput type="password" formControlName="password_confirmation" required minlength="8" maxlength="15" />
                    @if (registerForm.get('password_confirmation')?.hasError('passwordMismatch')) {
                        <mat-error>Passwords must match</mat-error>
                    }
                </mat-form-field>
                
                <div formGroupName="address" class="address-section">
                    <div class="address-section-zip">
                        <mat-form-field appearance="outline" class="inpt-address">
                            <mat-label>Address Line 1</mat-label>
                            <input matInput formControlName="addressLine1" required>
                        </mat-form-field>

                        <mat-form-field appearance="outline" class="inpt-address">
                            <mat-label>Address Line 2</mat-label>
                            <input matInput formControlName="addressLine2">
                        </mat-form-field>
                    </div>

                    <div class="address-section-zip">
                        <mat-form-field appearance="outline" class="inpt-zip">
                            <mat-label>ZIP Code</mat-label>
                            <input matInput formControlName="zipCode" maxlength="5" required>
                        </mat-form-field>

                        <mat-form-field appearance="outline" class="inpt-colony">
                            <mat-label>Colony</mat-label>
                            <input matInput formControlName="colony" required>
                        </mat-form-field>
                    </div>
                    
                    <div class="address-section-zip">  
                        <mat-form-field appearance="outline">
                            <mat-label>City</mat-label>
                            <input matInput formControlName="city" required>
                        </mat-form-field>
                    
                        <mat-form-field appearance="outline">
                            <mat-label>State</mat-label>
                            <input matInput formControlName="state" required>
                        </mat-form-field>
                    </div>
                </div>

                <label for="payment" id="payment" >Payment method</label>
                <mat-radio-group id="payment" name="payment" formControlName="payment" class="payment-group">
                    <mat-radio-button value="cash">Cash</mat-radio-button>
                    <mat-radio-button value="card">Card</mat-radio-button>
                </mat-radio-group>

            </form>
            <button matButton="filled" type="button" [disabled]="!registerForm.valid" class="btn-sign" (click)="onSubmit()">
                @if(loading()){
                    <mat-spinner diameter="30"></mat-spinner>
                }@else{
                    <span>Sign Up</span>
                }
            </button>
            <p class="form-footer">Do you have an account? <a [routerLink]="routes.auth.login">Sign In</a></p>
        </div>
    </div>

    <div class="image-side">
        <img src="assets/register.png" alt="Online Shop Image" />
    </div>
</main>